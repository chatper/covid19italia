(function(){function i(k,j){var l=$.grep(k,function(o,m){return j.indexOf(o)>=0});return l}function e(l){var j="";j+='<a href="'+l.url+'" class="card mb-15">';j+='<div class="card-body">';if(l.state!="open"){j+="<strike>"}j+='<h4 class="card-title">'+l.title+"</h4>";if(l.state!="open"){j+="</strike>"}j+="<small>";j+="<p>"+l.content.substring(0,250)+"...</p>";j+="<p>"+l.date+"</p>";j+="</small>";j+="</div>";j+='<div class="card-footer">';var m=l.label;var k=i(m,d);j+=k.join("|");j+="</div>";j+="</a>";return j}function c(m,j,o){var n=$("#search-results");if(m.length){var k="";var q=[];for(var l=0;l<m.length;l++){var p=j[m[l].ref];q.push(p)}q=q.sort(function(s,r){return -1*(parseInt(s.created_at)-parseInt(r.created_at))});k+='<div class="col-12">';for(var l=0;l<q.length;l++){var p=q[l];if(p.state=="open"){k+=e(p)}}k+="</div>";k+='<div class="col-12">';for(var l=0;l<q.length;l++){var p=q[l];if(p.state!="open"){k+=e(p)}}k+="</div>";n.html(k)}else{n.html("<li>Δεν βρέθηκε αναφορά</li>")}}function a(l,j){var m=$("#search-results");if(Object.keys(j).length){var k="";var n=[];$.each(j,function(o,p){n.push(p)});n=n.sort(function(p,o){return -1*(parseInt(p.created_at)-parseInt(o.created_at))});k+='<div class="col-12">';$.each(n,function(o,p){if(!l||$.inArray(l,p.label.toLowerCase().split(","))>=0){if(p.state=="open"){k+=e(p)}}});k+="</div>";k+='<div class="col-12">';$.each(n,function(o,p){if(!l||$.inArray(l,p.label.toLowerCase().split(","))>=0){if(p.state!="open"){k+=e(p)}}});k+="</div>";m.html(k)}else{m.html("<li>Δεν βρέθηκε αναφορά</li>")}}function g(j){var l=window.location.search.substring(1);var m=l.split("&");for(var k=0;k<m.length;k++){var n=m[k].split("=");if(n[0]===j){return decodeURIComponent(n[1].replace(/\+/g,"%20"))}}}function f(k,l,n){NProgress.start();if(k){var j=lunr(function(){this.ref("url");this.field("title",{boost:10});this.field("content");this.field("state");this.field("date");this.field("label");this.pipeline.remove(lunr.trimmer);this.pipeline.add(greekStemmer);this.pipeline.remove(lunr.stemmer);Object.keys(window.store).forEach(function(p){var q=window.store[p];q.url=p;this.add(q)},this)});var o=k.toLowerCase();var m=j.query(function(p){o.split(lunr.tokenizer.separator).forEach(function(q){p.term(q,{boost:100});if(o.lastIndexOf(" ")!=o.length-1){p.term(q,{usePipeline:false,wildcard:lunr.Query.wildcard.TRAILING,boost:10})}if(q!=""){p.term(q,{usePipeline:false,editDistance:1,boost:1})}})});c(m,window.store,n)}else{a(l,window.store,n)}NProgress.done()}var d=["Alloggi","acquisto solidale","Bambini","Bollettino","Bufale","Contatti","Donazioni","Fabbisogni","Notizie Utili","Ospitalita animali","Raccolte Fondi"];var b=g("query");var h=g("label");if(h){document.getElementById("labelchoice").value=h;h=h.toLowerCase()}NProgress.start();if(b){document.getElementById("search-box").setAttribute("value",b)}setTimeout(function(){if(window.store){f(b,h,d)}},0)})();document.getElementById("search-box").onkeydown=function(a){if(a.keyCode==13){NProgress.start()}};